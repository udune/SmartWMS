<UserControl x:Class="SmartWMS.Views.MaterialsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:SmartWMS.Views"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="1100"
             Background="{StaticResource BackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1"
                Padding="32,20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Breadcrumb -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                    <TextBlock Text="Home" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}" Cursor="Hand"/>
                    <TextBlock Text=" › " FontSize="13" Foreground="#cbd5e1"/>
                    <TextBlock Text="Inventory" FontSize="13" Foreground="{StaticResource TextSecondaryBrush}" Cursor="Hand"/>
                    <TextBlock Text=" › " FontSize="13" Foreground="#cbd5e1"/>
                    <TextBlock Text="Master Data" FontSize="13" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="Medium"/>
                </StackPanel>

                <Grid Grid.Row="1">
                    <StackPanel>
                        <TextBlock Text="Central Material Warehouse" FontSize="28" FontWeight="Black" Foreground="{StaticResource TextPrimaryBrush}"/>
                        <TextBlock Text="Centralized master data management for all warehouse materials." FontSize="14"
                                   Foreground="{StaticResource TextSecondaryBrush}" Margin="0,6,0,0"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- Toolbar -->
        <Border Grid.Row="1" Margin="32,20" Background="White" CornerRadius="12" Padding="16"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal">
                    <!-- Search -->
                    <Border Background="#f0f2f4" CornerRadius="8" Padding="12,0" Width="300">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE721;" FontFamily="Segoe MDL2 Assets" FontSize="16"
                                       Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                            <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                     Width="240" BorderThickness="0" Background="Transparent"
                                     VerticalAlignment="Center" Margin="8,0,0,0" Padding="0,10"
                                     FontSize="14">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Style.Triggers>
                                            <Trigger Property="Text" Value="">
                                                <Setter Property="Background">
                                                    <Setter.Value>
                                                        <VisualBrush Stretch="None" AlignmentX="Left">
                                                            <VisualBrush.Visual>
                                                                <TextBlock Text="Search by ID, Name, or Lot ID..." Foreground="#9ca3af" FontSize="14"/>
                                                            </VisualBrush.Visual>
                                                        </VisualBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>
                        </StackPanel>
                    </Border>

                    <!-- Type Filter -->
                    <ComboBox ItemsSource="{Binding MaterialTypes}" SelectedItem="{Binding SelectedType}"
                              Margin="12,0,0,0" Padding="12,10" Width="180" FontSize="14"
                              Background="#f0f2f4" BorderThickness="0">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock>
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="{Binding}"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding}" Value="">
                                                    <Setter Property="Text" Value="All Types"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Style="{StaticResource SecondaryButton}" Padding="10" Margin="0,0,8,0"
                            Command="{Binding RefreshCommand}" ToolTip="Refresh Data">
                        <TextBlock Text="&#xE72C;" FontFamily="Segoe MDL2 Assets" FontSize="16"/>
                    </Button>
                    <Button Style="{StaticResource SecondaryButton}" Padding="10" Margin="0,0,8,0"
                            ToolTip="Export CSV">
                        <TextBlock Text="&#xE896;" FontFamily="Segoe MDL2 Assets" FontSize="16"/>
                    </Button>
                    <Button Style="{StaticResource PrimaryButton}" Command="{Binding AddCommand}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE710;" FontFamily="Segoe MDL2 Assets" FontSize="16" VerticalAlignment="Center"/>
                            <TextBlock Text="Register New Material" Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Data Grid -->
        <Border Grid.Row="2" Margin="32,0,32,32" Background="White" CornerRadius="12"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <DataGrid ItemsSource="{Binding Materials}"
                          SelectedItem="{Binding SelectedMaterial}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          SelectionMode="Single"
                          HeadersVisibility="Column"
                          GridLinesVisibility="Horizontal"
                          HorizontalGridLinesBrush="#f0f2f4"
                          BorderThickness="0"
                          Background="Transparent"
                          RowBackground="White"
                          AlternatingRowBackground="#fafbfc"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="False">

                    <DataGrid.Resources>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="#f9fafb"/>
                            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="FontSize" Value="11"/>
                            <Setter Property="Padding" Value="16,12"/>
                            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                            <Setter Property="BorderThickness" Value="0,0,0,1"/>
                        </Style>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Padding" Value="16,12"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="DataGridCell">
                                        <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                                            <ContentPresenter VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#eff6ff"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Cursor" Value="Hand"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#eff6ff"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#f8fafc"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.Resources>

                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="100">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontWeight" Value="Medium"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="NAME" Binding="{Binding Name}" Width="180">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="VENDOR" Binding="{Binding Vendor}" Width="140">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="LOT ID" Binding="{Binding LotId}" Width="120">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontFamily" Value="Consolas"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTemplateColumn Header="TYPE" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border CornerRadius="12" Padding="10,4" HorizontalAlignment="Left">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="#f3e8ff"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Type}" Value="Thinner">
                                                        <Setter Property="Background" Value="#dbeafe"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Type}" Value="Developer">
                                                        <Setter Property="Background" Value="#ccfbf1"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <TextBlock Text="{Binding Type}" FontSize="12" FontWeight="Medium">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#7c3aed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Type}" Value="Thinner">
                                                            <Setter Property="Foreground" Value="#2563eb"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Type}" Value="Developer">
                                                            <Setter Property="Foreground" Value="#0d9488"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTextColumn Header="STOCK" Binding="{Binding StockQty, StringFormat={}{0} L}" Width="100">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                    <Setter Property="TextAlignment" Value="Right"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTemplateColumn Header="STATUS" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Ellipse Width="8" Height="8" Margin="0,0,8,0">
                                            <Ellipse.Style>
                                                <Style TargetType="Ellipse">
                                                    <Setter Property="Fill" Value="{StaticResource WarningBrush}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsExpired}" Value="True">
                                                            <Setter Property="Fill" Value="{StaticResource DangerBrush}"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding IsExpiringSoon}" Value="True">
                                                            <Setter Property="Fill" Value="{StaticResource WarningBrush}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Ellipse.Style>
                                        </Ellipse>
                                        <TextBlock FontSize="12">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Text" Value="Warehouse"/>
                                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsExpired}" Value="True">
                                                            <Setter Property="Text" Value="Expired"/>
                                                            <Setter Property="Foreground" Value="{StaticResource DangerBrush}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="ACTIONS" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Style="{StaticResource SecondaryButton}" Padding="8,4"
                                                BorderThickness="0" Background="Transparent"
                                                Command="{Binding DataContext.EditCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                ToolTip="Edit">
                                            <TextBlock Text="&#xE70F;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                                        </Button>
                                        <Button Style="{StaticResource SecondaryButton}" Padding="8,4"
                                                BorderThickness="0" Background="Transparent"
                                                Command="{Binding DataContext.DeleteCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                ToolTip="Delete">
                                            <TextBlock Text="&#xE74D;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                                                       Foreground="{StaticResource DangerBrush}"/>
                                        </Button>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Footer -->
                <Border Grid.Row="1" Background="#f9fafb" Padding="16,12"
                        BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0">
                    <Grid>
                        <TextBlock Text="Showing 1-5 of 128 materials" FontSize="12"
                                   Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Style="{StaticResource SecondaryButton}" Padding="8,6" Margin="0,0,8,0">
                                <TextBlock Text="&#xE76B;" FontFamily="Segoe MDL2 Assets" FontSize="12"/>
                            </Button>
                            <TextBlock Text="Page 1 of 32" FontSize="12" FontWeight="Medium"
                                       Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <Button Style="{StaticResource SecondaryButton}" Padding="8,6">
                                <TextBlock Text="&#xE76C;" FontFamily="Segoe MDL2 Assets" FontSize="12"/>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>
